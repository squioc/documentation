
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://docs.sekoia.io/intelligence_center/api/">
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.1.5">
    
    
      
        <title>API - SEKOIA.IO Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,700%7C&display=fallback">
        <style>:root{--md-text-font-family:"Open Sans";--md-code-font-family:""}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/sekoiaio.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#intelligence-center-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SEKOIA.IO Documentation" class="md-header__button md-logo" aria-label="SEKOIA.IO Documentation" data-md-component="logo">
      
  <img src="../../assets/sekoiaio.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SEKOIA.IO Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
      <div class="md-header__source">
        
<a href="https://github.com/SEKOIA-IO/documentation/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../getting_started/" class="md-tabs__link">
        Getting Started
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../operation_center/" class="md-tabs__link">
        Operation Center
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Intelligence Center
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../api/" class="md-tabs__link">
        API Documentation
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../releases" class="md-tabs__link">
      Whatâ€™s New?
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://support.sekoia.io" class="md-tabs__link">
      Support
    </a>
  </li>

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SEKOIA.IO Documentation" class="md-nav__button md-logo" aria-label="SEKOIA.IO Documentation" data-md-component="logo">
      
  <img src="../../assets/sekoiaio.svg" alt="logo">

    </a>
    SEKOIA.IO Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/SEKOIA-IO/documentation/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        Getting Started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/first_steps/" class="md-nav__link">
        First steps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/inviting_users_to_join_your_community/" class="md-nav__link">
        Inviting users to join your community
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/apikey_creation/" class="md-nav__link">
        API Key creation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/2fa/" class="md-nav__link">
        2-Factors Authentication
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6" type="checkbox" id="__nav_1_6" >
      
      <label class="md-nav__link" for="__nav_1_6">
        Search
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Search" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          Search
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../searching/dork/" class="md-nav__link">
        Dork Language
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../searching/search_events/" class="md-nav__link">
        Querying Operation Center Events
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Operation Center
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Operation Center" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Operation Center
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/threat_exposition/" class="md-nav__link">
        Dashboards
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      <label class="md-nav__link" for="__nav_2_3">
        Integrations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Integrations" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Integrations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_2" type="checkbox" id="__nav_2_3_2" >
      
      <label class="md-nav__link" for="__nav_2_3_2">
        Transports
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Transports" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_3_2">
          <span class="md-nav__icon md-icon"></span>
          Transports
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/transport/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/transport/rsyslog/" class="md-nav__link">
        Rsyslog
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/transport/logstash/" class="md-nav__link">
        Logstash
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/transport/syslog-ng/" class="md-nav__link">
        syslog-ng
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/transport/graylog/" class="md-nav__link">
        Graylog
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/transport/https/" class="md-nav__link">
        HTTPS
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_3" type="checkbox" id="__nav_2_3_3" >
      
      <label class="md-nav__link" for="__nav_2_3_3">
        Cloud and SaaS
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cloud and SaaS" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_3_3">
          <span class="md-nav__icon md-icon"></span>
          Cloud and SaaS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_3_1" type="checkbox" id="__nav_2_3_3_1" >
      
      <label class="md-nav__link" for="__nav_2_3_3_1">
        AWS
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="AWS" data-md-level="4">
        <label class="md-nav__title" for="__nav_2_3_3_1">
          <span class="md-nav__icon md-icon"></span>
          AWS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/aws_cloudtrail/" class="md-nav__link">
        CloudTrail
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/aws_flow_logs/" class="md-nav__link">
        Flow Logs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_3_2" type="checkbox" id="__nav_2_3_3_2" >
      
      <label class="md-nav__link" for="__nav_2_3_3_2">
        Microsoft Azure
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Microsoft Azure" data-md-level="4">
        <label class="md-nav__title" for="__nav_2_3_3_2">
          <span class="md-nav__icon md-icon"></span>
          Microsoft Azure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/azure_ad/" class="md-nav__link">
        Azure Active Directory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/azure_mysql/" class="md-nav__link">
        Azure Mysql
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/azure_linux/" class="md-nav__link">
        Azure Linux machines
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/azure_network_watcher/" class="md-nav__link">
        Azure Network Watcher
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/azure_windows/" class="md-nav__link">
        Azure Windows machines
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/o365/" class="md-nav__link">
        Microsoft Office 365
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_3_4" type="checkbox" id="__nav_2_3_3_4" >
      
      <label class="md-nav__link" for="__nav_2_3_3_4">
        Cisco Umbrella
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cisco Umbrella" data-md-level="4">
        <label class="md-nav__title" for="__nav_2_3_3_4">
          <span class="md-nav__icon md-icon"></span>
          Cisco Umbrella
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/umbrella_proxy/" class="md-nav__link">
        Proxy Logs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/umbrella_ip/" class="md-nav__link">
        Ip Logs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/umbrella_dns/" class="md-nav__link">
        Dns Logs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_4" type="checkbox" id="__nav_2_3_4" >
      
      <label class="md-nav__link" for="__nav_2_3_4">
        OS
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="OS" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_3_4">
          <span class="md-nav__icon md-icon"></span>
          OS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/auditbeat_linux/" class="md-nav__link">
        Auditbeat Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/windows/" class="md-nav__link">
        Windows
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/log_insight_windows/" class="md-nav__link">
        Log Insight Windows
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_5" type="checkbox" id="__nav_2_3_5" >
      
      <label class="md-nav__link" for="__nav_2_3_5">
        Application
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Application" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_3_5">
          <span class="md-nav__icon md-icon"></span>
          Application
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/alsid/" class="md-nav__link">
        Alsid
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/apache/" class="md-nav__link">
        Apache
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/bind/" class="md-nav__link">
        BIND
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/checkpoint/" class="md-nav__link">
        Checkpoint
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/cisco_asa/" class="md-nav__link">
        Cisco
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/f5-big-ip/" class="md-nav__link">
        F5 BigIP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/fortigate/" class="md-nav__link">
        FortiGate
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/fortimail/" class="md-nav__link">
        FortiMail
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/fortiweb/" class="md-nav__link">
        FortiWeb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/fortiproxy/" class="md-nav__link">
        FortiProxy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/haproxy/" class="md-nav__link">
        HAProxy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/harfanglab/" class="md-nav__link">
        HarfangLab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/dhcpd/" class="md-nav__link">
        ISC DHCP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/netfilter/" class="md-nav__link">
        NetFilter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/nginx/" class="md-nav__link">
        Nginx
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/openssh/" class="md-nav__link">
        OpenSSH
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/paloalto/" class="md-nav__link">
        PaloAlto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/postfix/" class="md-nav__link">
        Postfix
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/pulse/" class="md-nav__link">
        Pulse Connect Secure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/sophos/" class="md-nav__link">
        Sophos
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/spamassassin/" class="md-nav__link">
        SpamAssassin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/squid/" class="md-nav__link">
        Squid
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/suricata/" class="md-nav__link">
        Suricata
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/unbound/" class="md-nav__link">
        Unbound
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/zeek/" class="md-nav__link">
        Zeek
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_6" type="checkbox" id="__nav_2_3_6" >
      
      <label class="md-nav__link" for="__nav_2_3_6">
        Generic
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Generic" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_3_6">
          <span class="md-nav__icon md-icon"></span>
          Generic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/cef/" class="md-nav__link">
        Common Event Format
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      <label class="md-nav__link" for="__nav_2_4">
        Configure
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Configure" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Configure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/entities/" class="md-nav__link">
        Entities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/intakes/" class="md-nav__link">
        Intakes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/assets/" class="md-nav__link">
        Assets
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" type="checkbox" id="__nav_2_5" >
      
      <label class="md-nav__link" for="__nav_2_5">
        Detect
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Detect" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          Detect
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/rules_catalog/" class="md-nav__link">
        Rules Catalog
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" type="checkbox" id="__nav_2_6" >
      
      <label class="md-nav__link" for="__nav_2_6">
        Investigate
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Investigate" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Investigate
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/alerts/" class="md-nav__link">
        Alerts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/events/" class="md-nav__link">
        Events
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/cases/" class="md-nav__link">
        Cases
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7" type="checkbox" id="__nav_2_7" >
      
      <label class="md-nav__link" for="__nav_2_7">
        Automate
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Automate" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          Automate
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/playbook_overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/triggers/" class="md-nav__link">
        Triggers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/operators/" class="md-nav__link">
        Operators
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/actions/" class="md-nav__link">
        Actions
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation_center/faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Intelligence Center
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Intelligence Center" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Intelligence Center
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../data_model/" class="md-nav__link">
        Data Model
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        API
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    Authentication
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feeds" class="md-nav__link">
    Feeds
  </a>
  
    <nav class="md-nav" aria-label="Feeds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-feed" class="md-nav__link">
    Default Feed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feed-creation" class="md-nav__link">
    Feed Creation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feed-consumption" class="md-nav__link">
    Feed Consumption
  </a>
  
    <nav class="md-nav" aria-label="Feed Consumption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagination" class="md-nav__link">
    Pagination
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incremental-updates" class="md-nav__link">
    Incremental Updates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filtering-by-object-type" class="md-nav__link">
    Filtering by Object Type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-script" class="md-nav__link">
    Example Script
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-an-indicators-context" class="md-nav__link">
    Getting an indicator's context
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-an-object-by-its-id" class="md-nav__link">
    Getting an object by its ID
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#looking-for-an-ioc" class="md-nav__link">
    Looking for an IOC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#taxii" class="md-nav__link">
    TAXII
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../integrations/" class="md-nav__link">
        External Integrations
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_5" type="checkbox" id="__nav_3_5" >
      
      <label class="md-nav__link" for="__nav_3_5">
        Web Application
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Web Application" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          Web Application
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dashboard/" class="md-nav__link">
        Dashboards
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../graph_explorations/" class="md-nav__link">
        Graph Explorations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../observables/" class="md-nav__link">
        Observables
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../data_export/" class="md-nav__link">
        Data Export
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        API Documentation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API Documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Identity%20%26%20authentication/" class="md-nav__link">
        Identity & authentication
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../releases" class="md-nav__link">
        Whatâ€™s New?
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://support.sekoia.io" class="md-nav__link">
        Support
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    Authentication
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feeds" class="md-nav__link">
    Feeds
  </a>
  
    <nav class="md-nav" aria-label="Feeds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-feed" class="md-nav__link">
    Default Feed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feed-creation" class="md-nav__link">
    Feed Creation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feed-consumption" class="md-nav__link">
    Feed Consumption
  </a>
  
    <nav class="md-nav" aria-label="Feed Consumption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagination" class="md-nav__link">
    Pagination
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incremental-updates" class="md-nav__link">
    Incremental Updates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filtering-by-object-type" class="md-nav__link">
    Filtering by Object Type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-script" class="md-nav__link">
    Example Script
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-an-indicators-context" class="md-nav__link">
    Getting an indicator's context
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-an-object-by-its-id" class="md-nav__link">
    Getting an object by its ID
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#looking-for-an-ioc" class="md-nav__link">
    Looking for an IOC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#taxii" class="md-nav__link">
    TAXII
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/SEKOIA-IO/documentation/edit/master/docs/intelligence_center/api.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="intelligence-center-api">Intelligence Center API</h1>
<p>The API is reachable at <code>https://api.sekoia.io</code>. All Intelligence Center endpoints start with <code>https://api.sekoia.io/v2/inthreat/</code>.</p>
<h2 id="authentication">Authentication</h2>
<p>Authentication is required for all API endpoints. Authentication is done with the <code>Authorization</code> header:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Authorization: Bearer &lt;APIKEY&gt;
</code></pre></div>
<h2 id="feeds">Feeds</h2>
<p>A feed allows filtering the CTI Objects based on some filters.</p>
<p>The available filters are:</p>
<ul>
<li>Types</li>
<li>TLPs</li>
<li>Targeted sectors of activity</li>
<li>Targeted locations</li>
<li>Sources</li>
</ul>
<p>A feed can be consumed by all the users belonging to the community that created it.</p>
<h3 id="default-feed">Default Feed</h3>
<p>A default feed with no filters is available in all communities without having to create it.</p>
<p>The special feed ID to use is <code>d6092c37-d8d7-45c3-8aff-c4dc26030608</code>.</p>
<h3 id="feed-creation">Feed Creation</h3>
<p>The easiest way to create feed configurations is to use the Intelligence Center interface, by clicking on <code>Feeds</code> in the left menu. The dropdown next to the feed's name will allow you to copy the ID or the consumption URLs of the feed.</p>
<p><img alt="SEKOIA.IO Intelligence Center Feeds" src="../../assets/intelligence_center/feeds.png" style="width: 100%; max-width: 100%" /></p>
<p>If you would prefer creating the feed with the API, you can use the <a href="https://docs.sekoia.io/api/threat%20intelligence%20database#operation/post_feeds_resource">feeds</a> endpoint.</p>
<p>The result should contain the feed <code>id</code> that may be used to consume the feed.</p>
<h3 id="feed-consumption">Feed Consumption</h3>
<p>To consume the objects from a feed the following endpoint may be used: <code>GET v2/inthreat/collections/{feed_id}/objects</code>.</p>
<p>i.e. <code>GET v2/inthreat/collections/d6092c37-d8d7-45c3-8aff-c4dc26030608/objects/</code></p>
<p>Be aware that only the users belonging to the feed's community will be able to access it when using a custom feed.</p>
<h4 id="pagination">Pagination</h4>
<p>The <code>objects</code> endpoint returns only 100 objects by default but this value can be increased up to 2000 objects per request
with the <code>limit</code> parameter.</p>
<p>i.e. <code>GET v2/inthreat/collections/{feed_id}/objects?limit=2000</code></p>
<p>The response contains the STIX Objects in <code>items</code> and a pagination cursor in <code>next_cursor</code>.
You can pass this cursor using the cursor parameter to get the next page of content.</p>
<p>i.e. <code>GET v2/inthreat/collections/{feed_id}/objects?limit=2000&amp;cursor={next_cursor}</code></p>
<p>You can safely stop iterating when <code>items</code> is empty or less than the requested <code>limit</code>.</p>
<h4 id="incremental-updates">Incremental Updates</h4>
<p>It is recommended to only fetch the full feed content the first time and then to use incremental updates.</p>
<p>To get only the records that were created and/or modified since your last request, simply use the last
<code>next_cursor</code> that was returned in your request.</p>
<h4 id="filtering-by-object-type">Filtering by Object Type</h4>
<p>It is possible to filter returned objects by type with the <code>match[type]</code> parameter.
Its value should be a comma-separated list of types.</p>
<p>i.e. <code>GET v2/inthreat/collections/{feed_id}/objects?match[type]=indicator</code></p>
<p>Note that if the type is not available in the feed it will not be returned even if specified in the query.</p>
<h4 id="example-script">Example Script</h4>
<p>Here is a sample Python script to fetch STIX objects from the Intelligence Center:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span> <span class="nn">dbm</span>
<span class="linenos" data-linenos=" 2 "></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="linenos" data-linenos=" 3 "></span><span class="kn">from</span> <span class="nn">posixpath</span> <span class="kn">import</span> <span class="n">join</span> <span class="k">as</span> <span class="n">urljoin</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="n">APIKEY</span> <span class="o">=</span> <span class="s2">&quot;APIKEY&quot;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="n">DEFAULT_FEED</span> <span class="o">=</span> <span class="s2">&quot;d6092c37-d8d7-45c3-8aff-c4dc26030608&quot;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="n">BASE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://api.sekoia.io/v2/inthreat/&quot;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="n">CURSOR_FILE</span> <span class="o">=</span> <span class="s2">&quot;cursor.db&quot;</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="k">def</span> <span class="nf">get_new_objects</span><span class="p">(</span><span class="n">feed_id</span><span class="o">=</span><span class="n">DEFAULT_FEED</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">2000</span><span class="p">):</span>
<span class="linenos" data-linenos="13 "></span>    <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">BASE_URL</span><span class="p">,</span> <span class="s2">&quot;collections&quot;</span><span class="p">,</span> <span class="n">feed_id</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;objects?limit=</span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos" data-linenos="14 "></span>    <span class="n">paginated_url</span> <span class="o">=</span> <span class="n">url</span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span>    <span class="c1"># Use the builtin dbm module to save the cursors to disk</span>
<span class="linenos" data-linenos="17 "></span>    <span class="k">with</span> <span class="n">dbm</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">CURSOR_FILE</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cursors</span><span class="p">:</span>
<span class="linenos" data-linenos="18 "></span>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="linenos" data-linenos="19 "></span>            <span class="c1"># If a cursor exists for this feed, add it to the URL</span>
<span class="linenos" data-linenos="20 "></span>            <span class="k">if</span> <span class="n">feed_id</span> <span class="ow">in</span> <span class="n">cursors</span><span class="p">:</span>
<span class="linenos" data-linenos="21 "></span>                <span class="n">paginated_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&amp;cursor=</span><span class="si">{</span><span class="n">cursors</span><span class="p">[</span><span class="n">feed_id</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span>            <span class="c1"># Request the next batch of objects from the API, authenticate with the APIKEY</span>
<span class="linenos" data-linenos="24 "></span>            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="linenos" data-linenos="25 "></span>                <span class="n">paginated_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="n">APIKEY</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>
<span class="linenos" data-linenos="26 "></span>            <span class="p">)</span>
<span class="linenos" data-linenos="27 "></span>            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<span class="linenos" data-linenos="28 "></span>            <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="linenos" data-linenos="29 "></span>
<span class="linenos" data-linenos="30 "></span>            <span class="c1"># Yield individual STIX Objects (SDO &amp; SRO)</span>
<span class="linenos" data-linenos="31 "></span>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">]:</span>
<span class="linenos" data-linenos="32 "></span>                <span class="k">yield</span> <span class="n">item</span>
<span class="linenos" data-linenos="33 "></span>
<span class="linenos" data-linenos="34 "></span>            <span class="c1"># Update cursor to have incremental updates</span>
<span class="linenos" data-linenos="35 "></span>            <span class="n">cursors</span><span class="p">[</span><span class="n">feed_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;next_cursor&quot;</span><span class="p">]</span>
<span class="linenos" data-linenos="36 "></span>
<span class="linenos" data-linenos="37 "></span>            <span class="c1"># Stop current iteration if we reached the last updated object</span>
<span class="linenos" data-linenos="38 "></span>            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">:</span>
<span class="linenos" data-linenos="39 "></span>                <span class="k">break</span>
</code></pre></div>
<h2 id="getting-an-indicators-context">Getting an indicator's context</h2>
<p>When using indicators for detection, you might want to fetch all indicators by using a filter on the indicator type
and then only fetch additional context when an indicator matched.</p>
<p>The <code>v2/inthreat/objects/{indicator_id}/context</code> returns a STIX bundle containing:</p>
<ul>
<li>The indicator</li>
<li>The first level relationships and related objects</li>
<li>Potential relevant Course-Of-Action objects</li>
<li>Referenced Sources and Object Markings</li>
</ul>
<h2 id="getting-an-object-by-its-id">Getting an object by its ID</h2>
<p>It is possible to get a specific object by its ID by using the <code>GET v2/inthreat/objects/{object_id}</code> endpoint.</p>
<p>For relationships, use the <code>GET v2/inthreat/relationships/{relationship_id}</code> endpoint instead.</p>
<h2 id="looking-for-an-ioc">Looking for an IOC</h2>
<p>It is possible to look for a specific indicator of compromise in the Intelligence Center and get its context with the <code>GET v2/inthreat/indicators/context</code> endpoint (see <a href="https://docs.sekoia.io/api/intelligence%20center:%20cyber%20threat%20intelligence%20database#operation/get_indicator_context_resource">documentation</a>).</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span> <span class="nn">json</span>
<span class="linenos" data-linenos=" 2 "></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="linenos" data-linenos=" 3 "></span><span class="kn">from</span> <span class="nn">posixpath</span> <span class="kn">import</span> <span class="n">join</span> <span class="k">as</span> <span class="n">urljoin</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="n">APIKEY</span> <span class="o">=</span> <span class="s2">&quot;APIKEY&quot;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="n">BASE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://api.sekoia.io/v2/inthreat/&quot;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="n">HEADERS</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="n">APIKEY</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="linenos" data-linenos="10 "></span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="k">def</span> <span class="nf">get_indicator_context</span><span class="p">(</span><span class="n">observable_type</span><span class="p">,</span> <span class="n">observable_value</span><span class="p">):</span>
<span class="linenos" data-linenos="14 "></span>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="linenos" data-linenos="15 "></span>        <span class="n">urljoin</span><span class="p">(</span><span class="n">BASE_URL</span><span class="p">,</span> <span class="s2">&quot;indicators/context&quot;</span><span class="p">),</span>
<span class="linenos" data-linenos="16 "></span>        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">observable_type</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">observable_value</span><span class="p">},</span>
<span class="linenos" data-linenos="17 "></span>        <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">)</span>
<span class="linenos" data-linenos="18 "></span>    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span>    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre></div>
<h2 id="taxii">TAXII</h2>
<p>The Intelligence Center also exposes a TAXII 2.1 server that conforms to <a href="https://docs.oasis-open.org/cti/taxii/v2.1/csprd03/taxii-v2.1-csprd03.html">the specification</a>.</p>
<p>The discovery endpoint of the TAXII server is located at <code>https://app.sekoia.io/api/v2/inthreat/taxii-server/taxii2</code>.
The API root of the TAXII server is located at <code>https://app.sekoia.io/api/v2/inthreat/taxii-server</code>.
TAXII relies on HTTP Basic Authentication. To authenticate to the TAXII server, you should use your Intelligence Center API key as the Basic Authentication password (you can use any username).</p>
<p>Here is an example of a script using the TAXII endpoints to iterate over objects:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span> <span class="nn">dbm</span>
<span class="linenos" data-linenos=" 2 "></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="linenos" data-linenos=" 3 "></span><span class="kn">from</span> <span class="nn">basicauth</span> <span class="kn">import</span> <span class="n">encode</span> <span class="k">as</span> <span class="n">basicauth_encode</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="c1"># Replace with Intelligence Center API Key</span>
<span class="linenos" data-linenos=" 6 "></span><span class="n">APIKEY</span> <span class="o">=</span> <span class="s2">&quot;APIKEY&quot;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="c1"># Replace with the TAXII URL copied from the &quot;feeds&quot; page</span>
<span class="linenos" data-linenos=" 9 "></span><span class="n">FEED_URL</span> <span class="o">=</span> <span class="s2">&quot;https://app.sekoia.io/api/v2/inthreat/taxii-server/collections/d6092c37-d8d7-45c3-8aff-c4dc26030608/objects&quot;</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="n">CURSOR_FILE</span> <span class="o">=</span> <span class="s2">&quot;cursor.db&quot;</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="k">def</span> <span class="nf">get_new_objects</span><span class="p">(</span><span class="n">feed_url</span><span class="o">=</span><span class="n">FEED_URL</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;2.1&quot;</span><span class="p">):</span>
<span class="linenos" data-linenos="15 "></span>    <span class="n">has_more</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos" data-linenos="16 "></span>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos" data-linenos="17 "></span>        <span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;application/taxii+json&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="18 "></span>        <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="n">basicauth_encode</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="n">APIKEY</span><span class="p">),</span>
<span class="linenos" data-linenos="19 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="20 "></span>    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;match[spec_version]&quot;</span><span class="p">:</span> <span class="n">version</span><span class="p">,</span> <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span>    <span class="c1"># Use the builtin dbm module to save the cursors to disk</span>
<span class="linenos" data-linenos="23 "></span>    <span class="k">with</span> <span class="n">dbm</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">CURSOR_FILE</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cursors</span><span class="p">:</span>
<span class="linenos" data-linenos="24 "></span>        <span class="k">while</span> <span class="n">has_more</span><span class="p">:</span>
<span class="linenos" data-linenos="25 "></span>            <span class="c1"># If a cursor exists for this feed, add it to the parameters</span>
<span class="linenos" data-linenos="26 "></span>            <span class="k">if</span> <span class="n">feed_url</span> <span class="ow">in</span> <span class="n">cursors</span><span class="p">:</span>
<span class="linenos" data-linenos="27 "></span>                <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;next&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cursors</span><span class="p">[</span><span class="n">feed_url</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
<span class="linenos" data-linenos="28 "></span>
<span class="linenos" data-linenos="29 "></span>            <span class="c1"># Request the next batch of objects from the API, authenticate with the APIKEY</span>
<span class="linenos" data-linenos="30 "></span>            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">feed_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span>
<span class="linenos" data-linenos="31 "></span>            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<span class="linenos" data-linenos="32 "></span>            <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="linenos" data-linenos="33 "></span>
<span class="linenos" data-linenos="34 "></span>            <span class="n">has_more</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;more&quot;</span><span class="p">]</span>
<span class="linenos" data-linenos="35 "></span>            <span class="n">cursors</span><span class="p">[</span><span class="n">feed_url</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;next&quot;</span><span class="p">]</span>
<span class="linenos" data-linenos="36 "></span>
<span class="linenos" data-linenos="37 "></span>            <span class="k">yield from</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" title="Back to top" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../data_model/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Data Model
            </div>
          </div>
        </a>
      
      
        <a href="../integrations/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              External Integrations
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright 2021 SEKOIA. All rights reserved.
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://twitter.com/sekoia_fr" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tabs", "navigation.top"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.d351de03.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1609d9a.min.js"></script>
      
        <script src="../../javascript/sekoiaio.js"></script>
      
    
  </body>
</html>